<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Figo Cell</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Comic+Neue:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Jost:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Space+Grotesk:wght@300..700&display=swap"
      rel="stylesheet"
    />

    <!-- Open sauce -->
    <link href="https://fonts.cdnfonts.com/css/open-sauce-one" rel="stylesheet" />
    <!-- BS Icon -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <!-- Favicon -->
    <link rel="icon" href="{{ url_for('static', filename='favicon/favicon.png') }}" type="image/x-icon" />
    <!-- My Css -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
      $(document).ready(function () {
        // Handle Update Button Click
        $('form[action="/keranjang/update"]').on('submit', function (e) {
          e.preventDefault(); // Mencegah form submit secara default

          // Ambil data dari form
          var formData = $(this).serialize();

          $.ajax({
            url: '/keranjang/update',
            type: 'POST',
            data: formData,
            success: function (response) {
              // Menampilkan pesan sukses
              // Swal.fire({
              //   icon: 'success',
              //   title: 'Sukses',
              //   text: response.msg,
              //   timer: 2000,
              //   showConfirmButton: false,
              // });

              // Refresh atau update halaman (opsional)
              setTimeout(function () {
                location.reload(); // Reload halaman setelah pesan sukses
              }, 500); // Tunggu 2 detik sebelum refresh
            },
            error: function (xhr, status, error) {
              // Menampilkan pesan error
              Swal.fire({
                icon: 'error',
                title: 'Error',
                text: xhr.responseJSON.msg,
              });
            },
          });
        });
      });
    </script>
  </head>
  <style>
    .card-title,
    .card-text,
    p {
      text-align: justify;
      font-family: 'Poppins';
    }
    p {
      font-size: 12px !important;
    }
    span {
      color: #ff7f17;
      font-size: 16px !important;
      font-family: 'Poppins';
    }
    h5,
    .btn {
      font-family: 'Poppins';
      letter-spacing: 1px;
    }
    /* Responsive */
  </style>
  <body>
    <!-- Navbar -->
    <nav class="navbar fixed-top navbar-expand-lg text-white p-2 shadow navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand fw-bold" href="/" style="letter-spacing: 3px"> <img width="100px" height="50px" src="{{ url_for('static', filename='logo/logoFigo.png') }}" alt="My Image" /></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="offcanvas bg-dark offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasNavbarLabel"></h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body text-light">
            <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
              <li class="nav-item m-2" data-bs-dismiss="offcanvas" aria-label="Close">
                <a class="nav-link" aria-current="page" href="/"><i class="bi bi-house-door-fill me-3"></i>Home</a>
              </li>
              <li class="nav-item m-2" data-bs-dismiss="offcanvas" aria-label="Close">
                <a class="nav-link" aria-current="page" href="/product"><i class="bi bi-tags-fill me-3"></i> Produk</a>
              </li>
              <li class="nav-item m-2" data-bs-dismiss="offcanvas" aria-label="Close">
                <a class="nav-link" aria-current="page" href="/contact"> <i class="bi bi-person-lines-fill me-3"></i> Kontak</a>
              </li>
              <li class="nav-item m-2" data-bs-dismiss="offcanvas" aria-label="Close">
                <a class="nav-link active" aria-current="page" href="/keranjang"><i class="bi bi-cart-check-fill me-3"> </i>Keranjang </a>
              </li>

              {% if 'username' in session %}

              <div class="profile-dropdown">
                <a class="nav-link" aria-current="page" href="/profile/{{username}}"
                  >{{username}} <img class="rounded-circle profile-icon" src="{{ url_for('static', filename='testi/person1.jpg') }}" alt="My Image" width="40em" height="40em"
                /></a>
                <div class="dropdown-content">
                  <a class="text-danger" href="/logout">Logout</a>
                </div>
              </div>

              {% else %}
              <li class="nav-item m-2" data-bs-dismiss="offcanvas" aria-label="Close">
                <a class="nav-link active text-light btn btn-lg btn-transparent" aria-current="page" href="/login"
                  ><span><i class="bi bi-box-arrow-in-right"> Login</i> </span></a
                >
              </li>
              <li class="nav-item m-2" data-bs-dismiss="offcanvas" aria-label="Close">
                <a class="nav-link text-light btn" style="background-color: #825b32" href="/register"
                  ><span><i class="bi bi-person-plus"> Register</i></span>
                </a>
              </li>
              {% endif %}
            </ul>
          </div>
        </div>
      </div>
    </nav>
    <!-- End Navbar -->

    <!-- Keranjang -->
    <section style="margin-top: 10em">
      <div class="container">
        <h2 class="text-center">Keranjang Belanja</h2>
        <hr class="col-md-4 m-auto mb-3 mt-3" />
        <p class="col-md-6 m-auto">
          Keranjang Belanja Anda adalah tempat di mana semua produk pilihan Anda terkumpul sebelum melanjutkan ke proses checkout. Di sini, Anda dapat melihat rincian produk yang telah Anda tambahkan ke keranjang, termasuk nama produk,
          jumlah, harga, dan total harga keseluruhan. Jika Anda ingin mengubah jumlah produk atau menghapus produk dari keranjang, Anda dapat melakukannya dengan mudah.
        </p>

        <!-- Keranjang Produk -->
        <div class="row justify-content-center">
          {% if produk_keranjang %} {% for produk in produk_keranjang %}
          <div class="card m-3">
            <div class="row d-flex align-items-center">
              <div class="col-md-4">
                <img src="/{{ produk.file }}" class="img-fluid rounded mt-2 mb-2" alt="/{{ produk.nama }}" />
              </div>
              <div class="col">
                <div class="card-body">
                  <h5 class="card-title">{{ produk.nama }}</h5>
                  <p class="card-text fw-bold"><span>Harga: Rp {{ produk.harga }}</span></p>
                  <div class="row d-flex">
                    <div class="col-md-2">
                      <form action="/keranjang/update" method="POST">
                        <input type="hidden" name="nama_produk" value="{{ produk.nama }}" />
                        <input type="hidden" name="jumlah" value="{{ produk.jumlah }}" />
                        <input type="hidden" name="nama_produk" value="1" />
                        <button type="submit" class="btn d-flex align-items-center mb-3 text-dark" style="background-color: transparent; border: 1px solid black">
                          <p class="card-text">Qty : {{ produk.jumlah }} <i class="bi bi-plus-lg"></i></p>
                        </button>
                      </form>
                    </div>

                    <div class="col-md-2">
                      <form action="/keranjang/delete" method="POST">
                        <input type="hidden" name="nama_produk" value="{{ produk.nama }}" />
                        <button type="submit" class="btn btn-danger mb-3" style="background-color: red"><i class="bi bi-trash3"></i></button>
                      </form>
                    </div>
                  </div>
                  <div class="col-md-2">
                    <form method="POST" action="/checkout/{{ produk.nama }}">
                      <button type="submit" class="btn mb-3" style="background-color: green">Order</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          {% endfor %} {% else %}
          <p class="text-center">Keranjang Anda kosong.</p>
          {% endif %}
        </div>
        <!-- Total Harga -->
        {% if produk_keranjang %}
        <div class="row justify-content-center">
          <div class="col-md-4">
            <div class="card mt-5">
              <div class="card-body text-center">
                <h5 class="fw-bold">Total Harga : Rp {{ total_harga }}</h5>
                <form method="POST" action="/checkout">
                  <button type="submit" class="btn m-2" style="background-color: green">Checkout Semua</button>
                </form>
              </div>
            </div>
          </div>
        </div>
        {% endif %}
      </div>
    </section>
    <!-- End Keranjang -->

    <!-- Modal -->
    <div class="modal fade" id="updateModal" tabindex="-1" aria-labelledby="updateModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="updateModalLabel">Update Produk</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="updateForm">
              <input type="hidden" id="updateNamaProduk" name="nama_produk" />
              <div class="mb-3">
                <label for="updateJumlah" class="form-label">Jumlah</label>
                <input type="number" class="form-control" id="updateJumlah" name="jumlah" min="1" required />
              </div>
              <button type="submit" class="btn">Simpan Perubahan</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- End Modal -->

    <!-- Footer -->
    {% if produk_keranjang %} {% for produk in produk_keranjang %}
    <footer class="p-1 text-light bg-dark mt-3" style="border-top: 1px solid rgb(133, 127, 127)">
      <div class="container">
        <div class="row ms-auto">
          <div class="col-lg-4 mt-3">
            <h3 style="color: #825b32">FIgo Cell</h3>
            <p>
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Laborum sequi voluptate omnis exercitationem quod minima cumque, possimus est incidunt, aliquid veniam odio dignissimos sed, consequatur quasi cupiditate odit sit neque?
            </p>
            <a href="https://www.instagram.com/figocahyo_/"><i class="bi bi-instagram"></i></a>
            <a href="https://www.facebook.com/dimasdwi.figocahyo/"><i class="bi bi-facebook"></i></a>
            <a href="https://www.tiktok.com/@figox007"><i class="bi bi-tiktok"></i></a>
            <a href="https://wa.me/6288216733959"><i class="bi bi-whatsapp"></i></a>
            <a href="mailto:cahyodimas188@gmail.com"><i class="bi bi-envelope"></i></a>
          </div>
          <div class="col-lg-4 mt-3">
            <h3 style="color: #825b32">Hubungi Kami</h3>
            <a href="" class="text-light"><i class="bi bi-telephone-fill"></i>+62818281828</a>
            <br /><a href=""><i class="bi bi-chat-left-fill"></i> Lorem ipsum dolor sit amet.</a>
          </div>
          <div class="col-lg-4 mt-3">
            <li class="" style="list-style-type: none">
              <h3 style="color: #825b32">Menu Navigasi</h3>
              <a class="text-light" href="/product">Produk</a>
              <a class="text-light" href="/contact">Kontak</a>
              <a class="text-light" href="/keranjang">Keranjang </a>
              <br />
              <a class="text-light" href="/login">Login</a>
              <a class="text-light" href="/register">Register</a>
            </li>
          </div>
        </div>
        <hr />
        <p class="text-center">copyright@2024, Intel Celeron Team. All right reserved.</p>
      </div>
    </footer>
    {% endfor %} {% else %}
    <!-- End Footer -->
    <footer class="p-1 text-light bg-dark fixed-bottom" style="border-top: 1px solid rgb(133, 127, 127)">
      <div class="container">
        <div class="row ms-auto">
          <div class="col-lg-4 mt-3">
            <h3 style="color: #825b32">FIgo Cell</h3>
            <p>
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Laborum sequi voluptate omnis exercitationem quod minima cumque, possimus est incidunt, aliquid veniam odio dignissimos sed, consequatur quasi cupiditate odit sit neque?
            </p>
            <a href="https://www.instagram.com/figocahyo_/"><i class="bi bi-instagram"></i></a>
            <a href="https://www.facebook.com/dimasdwi.figocahyo/"><i class="bi bi-facebook"></i></a>
            <a href="https://www.tiktok.com/@figox007"><i class="bi bi-tiktok"></i></a>
            <a href="https://wa.me/6288216733959"><i class="bi bi-whatsapp"></i></a>
            <a href="mailto:cahyodimas188@gmail.com"><i class="bi bi-envelope"></i></a>
          </div>
          <div class="col-lg-4 mt-3">
            <h3 style="color: #825b32">Hubungi Kami</h3>
            <a href="" class="text-light"><i class="bi bi-telephone-fill"></i>+62818281828</a>
            <br /><a href=""><i class="bi bi-chat-left-fill"></i> Lorem ipsum dolor sit amet.</a>
          </div>
          <div class="col-lg-4 mt-3">
            <li class="" style="list-style-type: none">
              <h3 style="color: #825b32">Menu Navigasi</h3>
              <a class="text-light" href="/product">Produk</a>
              <a class="text-light" href="/contact">Kontak</a>
              <a class="text-light" href="/keranjang">Keranjang </a>
              <br />
              <a class="text-light" href="/login">Login</a>
              <a class="text-light" href="/register">Register</a>
            </li>
          </div>
        </div>
        <hr />
        <p class="text-center">copyright@2024, Intel Celeron Team. All right reserved.</p>
      </div>
    </footer>
    {% endif %}
    <!-- Swal -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- My AOS -->
    <!-- <script src="{{ url_for('static', filename='script.js') }}"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
  </body>
</html>
